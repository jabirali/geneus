<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Please click here for the documentation or here for the code.">
    
    <meta name="author" content="Jabir Ali Ouassou" >
    <link rel="icon" href="../favicon.png">

    <title>structure &ndash; ​ </title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">​ </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>structure
    <small>Derived Type</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="<p>10.4% of total for derived types.</p>Including implementation: 428 statements, 13.4% of total for derived types.">30 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/structure.f"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/structure.f.html'>structure.f</a></li>
    
     <li><a href='../module/structure_m.html'>structure_m</a></li>
    
  
     <li class="active">structure</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/structure.html#variable-a">a</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-b">b</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-supercurrent%7E2">supercurrent</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-lossycurrent%7E2">lossycurrent</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-accumulation%7E2">accumulation</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-correlation%7E2">correlation</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-magnetization">magnetization</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-distribution%7E2">distribution</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-density%7E2">density</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#cons-0">Constructor</a></h3></div>
  <div id="cons-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../type/structure.html#interface-structure">structure</a>
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#boundprocs-0">Type-Bound Procedures</a></h3></div>
  <div id="boundprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-push">push</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-conf">conf</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-cmap">cmap</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-fmap">fmap</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-initialize">initialize</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-save%7E2">save</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-load%7E2">load</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-update">update</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-update_prehook">update_prehook</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-update_posthook">update_posthook</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-converge">converge</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-write">write</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-difference">difference</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-materials">materials</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-selfconsistency">selfconsistency</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-superconductors">superconductors</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-chargeviolation">chargeviolation</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-gap">gap</a>
      
    </div>
  </div>
</div>





</div>

    </div>
    
    <div class="col-md-9" id='text'>
      <h2>type, public :: structure</h2>
    
    
    
    
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/structure.html#variable-a">a</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-b">b</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-supercurrent%7E2">supercurrent</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-lossycurrent%7E2">lossycurrent</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-accumulation%7E2">accumulation</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-correlation%7E2">correlation</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-magnetization">magnetization</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-distribution%7E2">distribution</a>
      
      <a class="list-group-item" href="../type/structure.html#variable-density%7E2">density</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#cons-1">Constructor</a></h3></div>
  <div id="cons-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../type/structure.html#interface-structure">structure</a>
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#boundprocs-1">Type-Bound Procedures</a></h3></div>
  <div id="boundprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-push">push</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-conf">conf</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-cmap">cmap</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-fmap">fmap</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-initialize">initialize</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-save%7E2">save</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-load%7E2">load</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-update">update</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-update_prehook">update_prehook</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-update_posthook">update_posthook</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-converge">converge</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-write">write</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-difference">difference</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-materials">materials</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-selfconsistency">selfconsistency</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-superconductors">superconductors</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-chargeviolation">chargeviolation</a>
      
      <a class="list-group-item" href="../type/structure.html#boundprocedure-gap">gap</a>
      
    </div>
  </div>
</div>





    </section>
    <br class="visible-xs visible-sm hidden-md">

    
    <section>
    <h2>Components</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-a"></span>class(<a href='../type/material.html'>material</a>),</td>
  
  <td>public,</td>
  <td>pointer</td><td>::</td>
  <td><strong>a</strong></td><td>=> </td><td>null()</td><td><p>First material</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-b"></span>class(<a href='../type/material.html'>material</a>),</td>
  
  <td>public,</td>
  <td>pointer</td><td>::</td>
  <td><strong>b</strong></td><td>=> </td><td>null()</td><td><p>Last  material</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-supercurrent%7E2"></span>integer,</td>
  
  <td>public,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>supercurrent</strong></td><td></td><td></td><td><p>Output unit (allocate to write supercurrents  to file)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lossycurrent%7E2"></span>integer,</td>
  
  <td>public,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>lossycurrent</strong></td><td></td><td></td><td><p>Output unit (allocate to write lossycurrents  to file)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-accumulation%7E2"></span>integer,</td>
  
  <td>public,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>accumulation</strong></td><td></td><td></td><td><p>Output unit (allocate to write accumulations  to file)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-correlation%7E2"></span>integer,</td>
  
  <td>public,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>correlation</strong></td><td></td><td></td><td><p>Output unit (allocate to write correlations   to file)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-magnetization"></span>integer,</td>
  
  <td>public,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>magnetization</strong></td><td></td><td></td><td><p>Output unit (allocate to write magnetizations to file)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-distribution%7E2"></span>integer,</td>
  
  <td>public,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>distribution</strong></td><td></td><td></td><td><p>Output unit (allocate to write distributions  to file)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-density%7E2"></span>integer,</td>
  
  <td>public,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>density</strong></td><td></td><td></td><td><p>Output unit (allocate to write density of states to file)</p></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
   <section>
   <h2>Constructor</h2>
     
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-structure"></span><h3>public interface <a href='../interface/structure.html'>structure</a>
    
  </h3></div>
  
  <ul class="list-group">
  
  
  
    <li class="list-group-item">
    
    
    <h3>
private impure function structure_construct() result(this)
    
    
   
</h3>
    



<p>Constructs a multilayer stack from a configuration file.</p>
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    

  
  
  
  
     <h4>Return Value <small>type(<a href='../type/structure.html'>structure</a>)
  </small></h4>
  
    

    </li>
  
  
  </ul>
</div>

     
   </section>
   <br>
    
    
    
    
     
    <section>
    <h2>Type-Bound Procedures</h2>
    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-push"></span><h3>procedure, public :: <strong>push</strong>  => structure_push 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Construct a single layer</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure subroutine structure_push(this, string)
    
    
   
</h3>
    



<p>Constructs a new class(material) object at the bottom of the multilayer stack.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>string</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-conf"></span><h3>procedure, public :: <strong>conf</strong>  => structure_conf 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Configure a single layer</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure subroutine structure_conf(this, key, val)
    
    
   
</h3>
    



<p>Configures the last material pushed to the multilayer stack.</p><a href="../proc/structure_conf.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>key</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>val</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-cmap"></span><h3>procedure, public :: <strong>cmap</strong>  => structure_cmap 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Configure  all layers</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure subroutine structure_cmap(this, key, val)
    
    
   
</h3>
    



<p>Maps a configuration option onto each element of the multilayer stack.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>key</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>val</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-fmap"></span><h3>procedure, public :: <strong>fmap</strong>  => structure_fmap 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Manipulate all layers</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure subroutine structure_fmap(this, routine, every)
    
    
   
</h3>
    



<p>Maps a subroutine onto each element of the multilayer stack.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td></td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(mappable)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>routine</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>every</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-initialize"></span><h3>procedure, public :: <strong>initialize</strong>  => structure_initialize 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Reset the physical state</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure subroutine structure_initialize(this)
    
    
   
</h3>
    



<p>Initializes the state of the entire multilayer stack.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td></td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-save%7E2"></span><h3>procedure, public :: <strong>save</strong>  => structure_save 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Save the physical state</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure subroutine structure_save(this)
    
    
   
</h3>
    



<p>Saves the state of the entire multilayer stack.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td></td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-load%7E2"></span><h3>procedure, public :: <strong>load</strong>  => structure_load 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Load the physical state</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure subroutine structure_load(this)
    
    
   
</h3>
    



<p>Loads the saved state of the multilayer stack.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td></td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-update"></span><h3>procedure, public :: <strong>update</strong>  => structure_update 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Update the physical state</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure subroutine structure_update(this, bootstrap)
    
    
   
</h3>
    



<p>Updates the state of the entire multilayer stack.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td></td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>bootstrap</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-update_prehook"></span><h3>procedure, public :: <strong>update_prehook</strong>  => structure_update_prehook 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Execute all update prehooks</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure subroutine structure_update_prehook(this)
    
    
   
</h3>
    



<p>Silently execute all update prehooks.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-update_posthook"></span><h3>procedure, public :: <strong>update_posthook</strong>  => structure_update_posthook 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Execute all update posthooks</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure subroutine structure_update_posthook(this)
    
    
   
</h3>
    



<p>Silently execute all update posthooks.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-converge"></span><h3>procedure, public :: <strong>converge</strong>  => structure_converge 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Update until convergence</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure subroutine structure_converge(this, threshold, iterations, bootstrap, prehook, posthook)
    
    
   
</h3>
    



<p>Performs a convergence procedure, where the state of every material in the stack
 is repeatedly updated until the residuals drop below some specified threshold 
 and/or a certain number of iterations have been performed. If bootstrap is set
 to true, the selfconsistency equations will only be solved once at the end, but
 not inbetween the individual iterations. If a prehook and/or posthook is given,
 those subroutines will be executed before/after each iteration of the update.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td></td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=wp),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>threshold</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>iterations</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>bootstrap</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(hook),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>prehook</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(hook),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>posthook</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-write"></span><h3>procedure, public :: <strong>write</strong>  => structure_write 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Write out observables</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure subroutine structure_write(this)
    
    
   
</h3>
    



<p>Writes physical observables to output files.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td></td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-difference"></span><h3>procedure, public :: <strong>difference</strong>  => structure_difference 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Check how much the physical state changes</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure function structure_difference(this) result(difference)
    
    
   
</h3>
    



<p>Checks how much the multilayer stack has changed recently.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td></td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=wp)
  </small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-materials"></span><h3>procedure, public :: <strong>materials</strong>  => structure_materials 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Check the number of enabled materials</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure function structure_materials(this) result(num)
    
    
   
</h3>
    



<p>Checks the number of enabled materials in the multilayer stack.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td></td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>integer
  </small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-selfconsistency"></span><h3>procedure, public :: <strong>selfconsistency</strong>  => structure_selfconsistency 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Whether selfconsistency iteration is required</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure function structure_selfconsistency(this) result(res)
    
    
   
</h3>
    



<p>Checks whether selfconsistency iteration is required.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td></td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>logical
  </small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-superconductors"></span><h3>procedure, public :: <strong>superconductors</strong>  => structure_superconductors 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Check the number of enables superconductors</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure function structure_superconductors(this) result(num)
    
    
   
</h3>
    



<p>Checks the number of selfconsistent superconductors in the multilayer stack.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td></td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>integer
  </small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-chargeviolation"></span><h3>procedure, public :: <strong>chargeviolation</strong>  => structure_chargeviolation 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Check the violation of charge conservation</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure function structure_chargeviolation(this) result(difference)
    
    
   
</h3>
    



<p>Checks how much the charge current varies with position. Since charge current
 is supposed to be conserved through the junction, this provides a measure of
 charge conservation violation, i.e. if the solution is physically realistic.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td></td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=wp)
  </small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-gap"></span><h3>procedure, public :: <strong>gap</strong>  => structure_gap 
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Check the minimum superconducting gap</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private impure function structure_gap(this) result(gap)
    
    
   
</h3>
    



<p>Obtains the mean gap in the enabled superconductor. If there are multiple such
 superconductors in the junction, then it returns the minimum of the mean gaps.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/structure.html'>structure</a>),</td>
  <td></td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=wp)
  </small></h4>
  
    

        
      
      </li>
    
  </ul>
</div>

    
    </section>
    
    
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>